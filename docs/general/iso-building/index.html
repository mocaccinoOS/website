<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.89.4" />
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>ISO building | MocaccinoOS</title>
<meta name="description" content="Building ISOs for testing or custom ISOs.">
<meta property="og:title" content="ISO building" />
<meta property="og:description" content="Building ISOs for testing or custom ISOs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.mocaccino.org/docs/general/iso-building/" /><meta property="article:section" content="docs" />

<meta property="article:modified_time" content="2024-02-04T21:42:58+01:00" /><meta property="og:site_name" content="MocaccinoOS" />

<meta itemprop="name" content="ISO building">
<meta itemprop="description" content="Building ISOs for testing or custom ISOs.">
<meta itemprop="dateModified" content="2024-02-04T21:42:58+01:00" />
<meta itemprop="wordCount" content="919">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ISO building"/>
<meta name="twitter:description" content="Building ISOs for testing or custom ISOs."/>




<link rel="preload" href="/scss/main.min.a6d2ef604367b3cb63ba331dc7cb5d25abac9a3c1292ff7abc01612ef0fba276.css" as="style">
<link href="/scss/main.min.a6d2ef604367b3cb63ba331dc7cb5d25abac9a3c1292ff7abc01612ef0fba276.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="/termynal.css">
<script src="/termynal.js"></script>
  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"></span><span class="text-uppercase font-weight-bold">MocaccinoOS</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/mocaccinoOS/mocaccino/issues" target="_blank" ><span>Issue tracker</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/blog/" ><span>Blog</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/community/" ><span>Community</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://packages.mocaccino.org" target="_blank" ><span>Packages</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/docs/contribution-guidelines/" ><span>Contribution guidelines</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/docs/donate/" ><span>Support us</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"><input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.6d189aabf2cad15df4cb7c19cb7498ba.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <div id="content-mobile">
  <form class="td-sidebar__search d-flex align-items-center">
    <input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.6d189aabf2cad15df4cb7c19cb7498ba.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  </div>
  <div id="content-desktop"></div>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docs-li">
  <a href="/docs/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-docs"><span class="">Documentation</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsdesktop-li">
  <a href="/docs/desktop/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsdesktop"><span class="">Mocaccino Desktop</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopdownload-li">
  <a href="/docs/desktop/download/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopdownload"><span class="">Download</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopusage-li">
  <a href="/docs/desktop/usage/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopusage"><span class="">Package manager</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopdesktop_environments-li">
  <a href="/docs/desktop/desktop_environments/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopdesktop_environments"><span class="">Desktop environments</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopdocker-li">
  <a href="/docs/desktop/docker/" title="Running docker" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopdocker"><span class="">Docker</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopwhalebrew-li">
  <a href="/docs/desktop/whalebrew/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopwhalebrew"><span class="">Whalebrew</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopappimage-li">
  <a href="/docs/desktop/appimage/" title="AppImages" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopappimage"><span class="">AppImage</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopflatpak-li">
  <a href="/docs/desktop/flatpak/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopflatpak"><span class="">Flatpak</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopvirt-manager-li">
  <a href="/docs/desktop/virt-manager/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopvirt-manager"><span class="">Virt-manager</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopapache_with_docker-li">
  <a href="/docs/desktop/apache_with_docker/" title="Install Apache webserver" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopapache_with_docker"><span class="">Apache webserver</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopbuilding_packages-li">
  <a href="/docs/desktop/building_packages/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopbuilding_packages"><span class="">Building packages locally</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsdesktopdevelopment-li">
  <a href="/docs/desktop/development/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsdesktopdevelopment"><span class="">Development guidelines</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopdevelopmenthowdoi-li">
  <a href="/docs/desktop/development/howdoi/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopdevelopmenthowdoi"><span class="">Frequent questions</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktoprepositories-li">
  <a href="/docs/desktop/repositories/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktoprepositories"><span class="">Repositories</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsdesktopmigration-li">
  <a href="/docs/desktop/migration/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsdesktopmigration"><span class="">Migration</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopmigrationgentoo-li">
  <a href="/docs/desktop/migration/gentoo/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopmigrationgentoo"><span class="">Migrating from Gentoo</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopmigrationsabayon-li">
  <a href="/docs/desktop/migration/sabayon/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopmigrationsabayon"><span class="">Migrating from Sabayon</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docsgeneral-li">
  <a href="/docs/general/" title="General section" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsgeneral"><span class="">General</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-docsgeneraliso-building-li">
  <a href="/docs/general/iso-building/" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id="m-docsgeneraliso-building"><span class="td-sidebar-nav-active-item">ISO building</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgeneralnetwork-config-li">
  <a href="/docs/general/network-config/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgeneralnetwork-config"><span class="">Network configuration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgeneralkernels-li">
  <a href="/docs/general/kernels/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgeneralkernels"><span class="">Switching kernels</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgeneralsystem-config-li">
  <a href="/docs/general/system-config/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgeneralsystem-config"><span class="">System Configuration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgeneralsystem-profiles-li">
  <a href="/docs/general/system-profiles/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgeneralsystem-profiles"><span class="">System profiles</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsmicro-li">
  <a href="/docs/micro/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsmicro"><span class="">Mocaccino Micro</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmicroservice-management-li">
  <a href="/docs/micro/service-management/" title="Service Management and Init" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmicroservice-management"><span class="">Init and Services</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmicroinstallation-li">
  <a href="/docs/micro/installation/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmicroinstallation"><span class="">Installation notes</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmicrobuilding-packages-li">
  <a href="/docs/micro/building-packages/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmicrobuilding-packages"><span class="">Building packages with Micro and k3s</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmicrodocker-li">
  <a href="/docs/micro/docker/" title="Running docker" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmicrodocker"><span class="">Docker</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmicrowireguard-li">
  <a href="/docs/micro/wireguard/" title="Running wireguard" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmicrowireguard"><span class="">Wireguard</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontribution-guidelines-li">
  <a href="/docs/contribution-guidelines/" title="Contributing to MocaccinoOS" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docscontribution-guidelines"><span class="">Contribution guidelines</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdonate-li">
  <a href="/docs/donate/" title="Donate" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdonate"><span class="">Support us</span></a>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href="https://github.com/MocaccinoOS/website/tree/master/content/en/docs/General/iso-building.md" class="td-page-meta--view" target="_blank" rel="noopener"><i class="fa fa-file-alt fa-fw"></i> View page source</a>
  <a href="https://github.com/MocaccinoOS/website/edit/master/content/en/docs/General/iso-building.md" class="td-page-meta--edit" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
  <a href="https://github.com/MocaccinoOS/website/new/master/content/en/docs/General/iso-building.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Create child page</a>
  <a href="https://github.com/MocaccinoOS/website/issues/new?title=ISO%20building" class="td-page-meta--issue" target="_blank" rel="noopener"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
  <a href="https://github.com/MocaccinoOS/issues/new" class="td-page-meta--project-issue" target="_blank" rel="noopener"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
  
</div>

            


<div class="td-toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#iso-building">ISO Building</a>
      <ul>
        <li><a href="#docker-installation">Docker installation</a></li>
        <li><a href="#creating-a-dockerfile">Creating a Dockerfile</a></li>
        <li><a href="#building-the-docker-image">Building the docker image</a></li>
        <li><a href="#building-the-iso">Building the ISO</a></li>
      </ul>
    </li>
  </ul>
</nav></div>



            

	
		



  
  

	
		



  
  

	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="https://www.mocaccino.org/docs/">Documentation</a>
  </li>
  <li class="breadcrumb-item">
    <a href="https://www.mocaccino.org/docs/general/">General</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">
    <a href="https://www.mocaccino.org/docs/general/iso-building/">ISO building</a>
  </li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>ISO building</h1>
	<div class="lead">Building ISOs for testing or custom ISOs.</div>
	<header class="article-meta">
		
		
			
				


			
				


			
		
		
	</header>    
	<h2 id="iso-building">ISO Building</h2>
<p>The ISO building process is performed within dockers to keep ISOs clean and uncontaiminated by unnecessary dev files, temp files, etc.</p>
<h3 id="docker-installation">Docker installation</h3>
<p>If you&rsquo;re planning on using docker as a user rather than just from root, you&rsquo;ll want additional packages such as entity/docker and acct-group/docker, but they aren&rsquo;t necessary for our purposes.</p>
<pre tabindex="0"><code>root@mocaccino:~# luet install container/docker systemd-service/dockerd
root@mocaccino:~# systemctl enable docker; systemctl start docker
</code></pre><p>If you&rsquo;re using mocaccino-micro, you&rsquo;ll use runit-srv/dockerd instead of systemd-service.</p>
<pre tabindex="0"><code>root@mocaccino:~# luet install container/docker runit-srv/dockerd
root@mocaccino:~# runit-enable dockerd; runit-start dockerd
</code></pre><h3 id="creating-a-dockerfile">Creating a Dockerfile</h3>
<p>You&rsquo;ll need a dockerfile that tells docker how to build our image and what it should do. Lets start by creating a dedicated directory for this work.</p>
<pre tabindex="0"><code>root@mocaccino:~# mkdir -p Docker/iso-builder
root@mocaccino:~/Docker/iso-builder# cd Docker/iso-builder
root@mocaccino:~/Docker/iso-builder# touch Dockerfile
root@mocaccino:~/Docker/iso-builder# vim Dockerfile
</code></pre><p>Now what do we need in this dockerfile?</p>
<pre tabindex="0"><code>FROM ubuntu
RUN apt-get update
RUN apt-get install curl xorriso squashfs-tools dosfstools
RUN curl https://get.mocaccino.org/luet/get_luet_root.sh | sh
RUN luet install -y extension/makeiso 
WORKDIR /output
ENTRYPOINT [&quot;/usr/bin/luet-makeiso&quot;]
</code></pre><p>So what exactly is happening here? We&rsquo;re telling docker we want our image to start <strong>FROM</strong> the ubuntu core image which is very small and extremely lean.
Then we&rsquo;re telling docker to <strong>RUN</strong> these commands inside the docker for setup. These command update the apt repos, install a few required tools, install luet via a script, and add the makeiso luet extension. Then we&rsquo;re saying we need a <strong>WORKDIR</strong> where we&rsquo;re going to output our file file and we want that to be a folder we link outside the docker so we can have that ISO outside of the docker. Then we&rsquo;re using <strong>ENTRYPOINT</strong> to tell docker after the image is built and started, what command do we want the docker to run?</p>
<p>Want to start from Gentoo Stage3 <strong>(WIP)</strong>? Try this Dockerfile:</p>
<pre tabindex="0"><code>FROM gentoo/stage3:systemd
RUN rm -rf /var/lock
RUN mkdir -p /var/lock/
RUN touch /var/lock/luet.lock
RUN curl https://get.mocaccino.org/luet/get_luet_root.sh | sh
RUN luet install -y extension/makeiso sys-fs/squashfs-tools sys-fs/dosfstools dev-libs/libisoburn
WORKDIR /output
ENTRYPOINT [&quot;/usr/bin/luet-makeiso&quot;]
</code></pre><h3 id="building-the-docker-image">Building the docker image</h3>
<p>Building the docker image and installing/running the docker container are different. Building the docker image means you have the starting point image built and ready, but doesn&rsquo;t mean the docker container installed and running. We&rsquo;ll be building and tagging this image with a name.</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@mocaccino:~/Docker/iso-builder# docker build -t iso-builder .
</code></pre></td></tr></table>
</div>
</div><p>What is this command doing? Its telling <strong>docker</strong> to <strong>build</strong> the <strong>Dockerfile</strong> inside the current directory <strong>(.)</strong> and tag <strong>(-t)</strong> it with the name <strong>iso-builder</strong>. When this is complete you should see something like this at the end:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Successfully built af8d3b35de70
Successfully tagged iso-builder:latest
</code></pre></td></tr></table>
</div>
</div><p>This means the docker image was successfully built and it has been tagged/named iso-builder:latest. What is with the &ldquo;:latest&rdquo;? Well you can have multiple revisions of docker and tag them with different version numbers. For example if I was maintaining 2 different versions such as how ubuntu LTS has multiple still supported versions we could tag it like :1804 and :2004, but for our usecases we won&rsquo;t be doing that. We&rsquo;ll just be using latest.</p>
<h3 id="building-the-iso">Building the ISO</h3>
<p>Now we have a docker image we can use to build clean ISOs from scratch, but we&rsquo;re still not done.  the <strong>ENTRYPOINT</strong> command luet-makeiso requires arguements. running the command alone doesn&rsquo;t just build an ISO. It needs instructions on the list of layers and packages to download and install to build a specific spin of MocaccinoOS. For the simplicity of the guide we&rsquo;ll just be using Gnome, but there are multiple Mocaccino flavors for you to choose from. You can build from a pre-built specification or you can tweak a specification to make your own ISO build. Our specification files are stored at <a href="https://github.com/mocaccinoOS/mocaccino/tree/master/specs">https://github.com/mocaccinoOS/mocaccino/tree/master/specs</a>.</p>
<p>Lets download the <code>gnome.yaml</code> spec file into our iso-builder directory.</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@mocaccino:~/Docker/iso-builder# curl https://raw.githubusercontent.com/mocaccinoOS/mocaccino/master/specs/gnome.yaml
</code></pre></td></tr></table>
</div>
</div><p>Our iso-builder directory should now look like this:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@mocaccino:~/Docker/iso-builder# ls
Dockerfile  gnome.yaml
</code></pre></td></tr></table>
</div>
</div><p>Lets tell Docker to run our newly built docker container image and tell it to build us an ISO!</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@mocaccino:~/Docker/iso-builder# docker run -ti -v <span style="color:#40ffff">$PWD</span>:/output --privileged=<span style="color:#24909d">true</span> --rm iso-builder:latest gnome.yaml
</code></pre></td></tr></table>
</div>
</div><p>So whats happening here exactly? We&rsquo;re telling <strong>docker</strong> run a docker container using the <strong>iso-builder:latest</strong> image we built and we want to see the output run in a new tty/shell that is interactive <strong>(-ti)</strong> and we&rsquo;re binding <strong>(-v)</strong> our current folder <strong>($PWD)</strong> to a folder inside the docker <strong>/output</strong>. Now files in our current directly will be accessible to the docker and files the docker creates in that directory will be accessible to us. We also want the docker to delete itself when the job is complete <strong>(&ndash;rm)</strong>. We also need privileges to fork the processes for speed <strong>(&ndash;privileged=true)</strong>. We&rsquo;re passing an argument <strong>(gnome.yaml)</strong> to the command at the <strong>ENTRYPOINT</strong> command of the docker. So Effectively the docker is running the command <code>/usr/bin/luet-makeiso gnome.yaml</code> and that <code>gnome.yaml</code> file is accessible because its in the <strong>WORKDIR</strong> /output that we binded to the docker.</p>
<p>Now the docker will begin as a minimal image installing all required files via luet to have a bootable mocaccino gnome system. This will take some time. After all the packages are installed into the docker it will begin building an ISO of the current snapshot of that docker. After the ISO build is complete, the ISO will be dumped into /output which also happens to be the current directory your in on the host system <code>~/Docker/iso-builder#</code>. After that is complete, the docker will proceed to remove itself. This cleans up any unncessary dockers and bloat on your system, but leaves you with the ISO in your iso-builder directory.</p>

	
	
	<div class="text-muted mt-5 pt-3 border-top">
  Last modified February 4, 2024: <a href="https://github.com/MocaccinoOS/website/commit/2b26a21fa53d1c9282432639c67126a412167875">Update desktop_environments.md (2b26a21)</a>
</div>

</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Forum" aria-label="Forum">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/mocaccinoOS/mocaccino/discussions" aria-label="Forum">
      <i class="fab fa-discourse"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Telegram" aria-label="Telegram">
    <a class="text-white" target="_blank" rel="noopener" href="https://t.me/mocaccinoOS" aria-label="Telegram">
      <i class="fab fa-telegram"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/MocaccinoOs" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Matrix chat" aria-label="Matrix chat">
    <a class="text-white" target="_blank" rel="noopener" href="https://matrix.to/#/#mocaccinoOS:matrix.org" aria-label="Matrix chat">
      <i class="fas fa-comments"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/MocaccinoOS" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener" href="https://join.slack.com/t/luet/shared_invite/enQtOTQxMjcyNDQ0MDUxLWQ5ODVlNTI1MTYzNDRkYzkyYmM1YWE5YjM0NTliNDEzNmQwMTkxNDRhNDIzM2Y5NDBlOTZjZTYxYWQyNDE4YzY" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2024 MocaccinoOS org. All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='/js/tabpane-persist.js'></script>




















<script src="/js/main.min.8ab8f81ff7e1454d30024cd6f956d4d341c3a97e2a673f988065f2ee4e147922.js" integrity="sha256-irj4H/fhRU0wAkzW&#43;VbU00HDqX4qZz&#43;YgGXy7k4UeSI=" crossorigin="anonymous"></script>




  </body>
</html>