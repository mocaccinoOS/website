<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.89.4" />
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Building packages locally | MocaccinoOS</title>
<meta name="description" content="How to build packages on MocaccinoOS with portage (or not)">
<meta property="og:title" content="Building packages locally" />
<meta property="og:description" content="How to build packages on MocaccinoOS with portage (or not)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.mocaccino.org/docs/desktop/building_packages/" /><meta property="article:section" content="docs" />

<meta property="article:modified_time" content="2025-02-11T20:15:37+01:00" /><meta property="og:site_name" content="MocaccinoOS" />

<meta itemprop="name" content="Building packages locally">
<meta itemprop="description" content="How to build packages on MocaccinoOS with portage (or not)">
<meta itemprop="dateModified" content="2025-02-11T20:15:37+01:00" />
<meta itemprop="wordCount" content="869">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Building packages locally"/>
<meta name="twitter:description" content="How to build packages on MocaccinoOS with portage (or not)"/>




<link rel="preload" href="/scss/main.min.a6d2ef604367b3cb63ba331dc7cb5d25abac9a3c1292ff7abc01612ef0fba276.css" as="style">
<link href="/scss/main.min.a6d2ef604367b3cb63ba331dc7cb5d25abac9a3c1292ff7abc01612ef0fba276.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="/termynal.css">
<script src="/termynal.js"></script>
  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"></span><span class="text-uppercase font-weight-bold">MocaccinoOS</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/mocaccinoOS/mocaccino/issues" target="_blank" ><span>Issue tracker</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/blog/" ><span>Blog</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/community/" ><span>Community</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://packages.mocaccino.org" target="_blank" ><span>Packages</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/docs/contribution-guidelines/" ><span>Contribution guidelines</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/docs/donate/" ><span>Support us</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"><input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.14baee1978882952f839274322a47ec6.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <div id="content-mobile">
  <form class="td-sidebar__search d-flex align-items-center">
    <input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.14baee1978882952f839274322a47ec6.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  </div>
  <div id="content-desktop"></div>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docs-li">
  <a href="/docs/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-docs"><span class="">Documentation</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docsdesktop-li">
  <a href="/docs/desktop/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsdesktop"><span class="">Mocaccino Desktop</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopdownload-li">
  <a href="/docs/desktop/download/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopdownload"><span class="">Download</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopusage-li">
  <a href="/docs/desktop/usage/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopusage"><span class="">Package manager</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopdesktop_environments-li">
  <a href="/docs/desktop/desktop_environments/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopdesktop_environments"><span class="">Desktop environments</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopdocker-li">
  <a href="/docs/desktop/docker/" title="Running docker" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopdocker"><span class="">Docker</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopwhalebrew-li">
  <a href="/docs/desktop/whalebrew/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopwhalebrew"><span class="">Whalebrew</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopperformance-li">
  <a href="/docs/desktop/performance/" title="Performance Optimizations" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopperformance"><span class="">Performance</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopappimage-li">
  <a href="/docs/desktop/appimage/" title="AppImages" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopappimage"><span class="">AppImage</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopflatpak-li">
  <a href="/docs/desktop/flatpak/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopflatpak"><span class="">Flatpak</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopgaming-li">
  <a href="/docs/desktop/gaming/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopgaming"><span class="">Gaming</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopvirt-manager-li">
  <a href="/docs/desktop/virt-manager/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopvirt-manager"><span class="">Virt-manager</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopapache_with_docker-li">
  <a href="/docs/desktop/apache_with_docker/" title="Install Apache webserver" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopapache_with_docker"><span class="">Apache webserver</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-docsdesktopbuilding_packages-li">
  <a href="/docs/desktop/building_packages/" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id="m-docsdesktopbuilding_packages"><span class="td-sidebar-nav-active-item">Building packages locally</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsdesktopdevelopment-li">
  <a href="/docs/desktop/development/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsdesktopdevelopment"><span class="">Development guidelines</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopdevelopmenthowdoi-li">
  <a href="/docs/desktop/development/howdoi/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopdevelopmenthowdoi"><span class="">Frequent questions</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktoprepositories-li">
  <a href="/docs/desktop/repositories/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktoprepositories"><span class="">Repositories</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsdesktopmigration-li">
  <a href="/docs/desktop/migration/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsdesktopmigration"><span class="">Migration</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopmigrationgentoo-li">
  <a href="/docs/desktop/migration/gentoo/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopmigrationgentoo"><span class="">Migrating from Gentoo</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdesktopmigrationsabayon-li">
  <a href="/docs/desktop/migration/sabayon/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdesktopmigrationsabayon"><span class="">Migrating from Sabayon</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsgeneral-li">
  <a href="/docs/general/" title="General section" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsgeneral"><span class="">General</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgeneraliso-building-li">
  <a href="/docs/general/iso-building/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgeneraliso-building"><span class="">ISO building</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgeneralnetwork-config-li">
  <a href="/docs/general/network-config/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgeneralnetwork-config"><span class="">Network configuration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgeneralkernels-li">
  <a href="/docs/general/kernels/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgeneralkernels"><span class="">Switching kernels</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgeneralsystem-config-li">
  <a href="/docs/general/system-config/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgeneralsystem-config"><span class="">System Configuration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgeneralsystem-profiles-li">
  <a href="/docs/general/system-profiles/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgeneralsystem-profiles"><span class="">System profiles</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsmicro-li">
  <a href="/docs/micro/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsmicro"><span class="">Mocaccino Micro</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmicroservice-management-li">
  <a href="/docs/micro/service-management/" title="Service Management and Init" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmicroservice-management"><span class="">Init and Services</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmicroinstallation-li">
  <a href="/docs/micro/installation/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmicroinstallation"><span class="">Installation notes</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmicrobuilding-packages-li">
  <a href="/docs/micro/building-packages/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmicrobuilding-packages"><span class="">Building packages with Micro and k3s</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmicrodocker-li">
  <a href="/docs/micro/docker/" title="Running docker" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmicrodocker"><span class="">Docker</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmicrowireguard-li">
  <a href="/docs/micro/wireguard/" title="Running wireguard" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmicrowireguard"><span class="">Wireguard</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontribution-guidelines-li">
  <a href="/docs/contribution-guidelines/" title="Contributing to MocaccinoOS" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docscontribution-guidelines"><span class="">Contribution guidelines</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdonate-li">
  <a href="/docs/donate/" title="Donate" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdonate"><span class="">Support us</span></a>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href="https://github.com/MocaccinoOS/website/tree/master/content/en/docs/Desktop/building_packages.md" class="td-page-meta--view" target="_blank" rel="noopener"><i class="fa fa-file-alt fa-fw"></i> View page source</a>
  <a href="https://github.com/MocaccinoOS/website/edit/master/content/en/docs/Desktop/building_packages.md" class="td-page-meta--edit" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
  <a href="https://github.com/MocaccinoOS/website/new/master/content/en/docs/Desktop/building_packages.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Create child page</a>
  <a href="https://github.com/MocaccinoOS/website/issues/new?title=Building%20packages%20locally" class="td-page-meta--issue" target="_blank" rel="noopener"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
  <a href="https://github.com/MocaccinoOS/issues/new" class="td-page-meta--project-issue" target="_blank" rel="noopener"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
  
</div>

            


<div class="td-toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#create-a-workspace">Create a workspace</a></li>
    <li><a href="#first-package">First package</a></li>
    <li><a href="#building-the-package">Building the package</a></li>
    <li><a href="#install-the-package">Install the package</a></li>
    <li><a href="#advanced-topics">Advanced topics</a>
      <ul>
        <li><a href="#showing-package-files">Showing package files</a></li>
        <li><a href="#find-duplicate-files-shipped-by-packages">Find duplicate files shipped by packages</a></li>
        <li><a href="#removing-generated-docker-images">Removing generated docker images</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>



            

	
		



  
  

	
		



  
  

	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="https://www.mocaccino.org/docs/">Documentation</a>
  </li>
  <li class="breadcrumb-item">
    <a href="https://www.mocaccino.org/docs/desktop/">Mocaccino Desktop</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">
    <a href="https://www.mocaccino.org/docs/desktop/building_packages/">Building packages locally</a>
  </li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Building packages locally</h1>
	<div class="lead">How to build packages on MocaccinoOS with portage (or not)</div>
	<header class="article-meta">
		
		
			
				


			
				


			
		
		
	</header>    
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    <p>Building packages is a complex topic. Installing packages coming from untrusted repositories, or building packages in the <em>wrong</em> way might break your system.</p>
<p>The following steps should only be carried out on test systems. Do make sure you have any important data backed up before installing any package.</p>


</div>

<p>MocaccinoOS desktop, even if based on portage, doesn&rsquo;t support the direct usage of <code>emerge</code>. Although it&rsquo;s possible to compile and install packages from portage.</p>
<p>To build a system package, instead use <code>luet build</code>. The following document tries to summarize the steps to build a package with emerge with <code>luet build</code>, and install and track it in a MocaccinoOS Desktop system, should cover the scenario: <em>&ldquo;hey, can I install packages with emerge?&quot;</em>.</p>
<h2 id="requirements">Requirements</h2>
<ul>
<li>Be sure to have <a href="/docs/desktop/docker">docker</a> installed, and the daemon running. The document is assuming you are carrying the steps on MocaccinoOS Desktop (GNOME in the specific case).</li>
<li>At least 30G of free disk space. To reclaim the space afterwards, run <code>docker system prune --force --volumes --all</code></li>
</ul>
<p>Follow the steps described in <a href="/docs/desktop/docker">this document</a> before going ahead.</p>
<h2 id="create-a-workspace">Create a workspace</h2>
<p>First of all, let&rsquo;s create a workspace. The packages that we will build have to persist somewhere in your local system, the location must be accessible while performing a <code>luet upgrade</code>. We will use <code>/user/system_repository</code> as an example. And we will assume the commands are running as root.</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mkdir -p /user/system_repository/tree
$ <span style="color:#24909d">cd</span> /user/system_repository
</code></pre></td></tr></table>
</div>
</div><p>All the commands from now on will be carried from the <code>/user/system_repository</code> directory.</p>
<h2 id="first-package">First package</h2>
<p>Let&rsquo;s put our eyes on, let&rsquo;s say, <a href="https://packages.gentoo.org/packages/games-board/gnome-chess">games-board/gnome-chess</a>, and create a compilation definition for it.</p>
<p>Let&rsquo;s first declare it&rsquo;s canonical name, or how you would actually install it afterwards with <code>luet</code> (e.g. <code>luet install app/gnome-chess</code>)</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mkdir tree/gnome-chess
$ cat <span style="color:#ed9d13">&lt;&lt;EOF &gt;&gt;tree/gnome-chess/definition.yaml
</span><span style="color:#ed9d13">category: &#34;apps&#34;
</span><span style="color:#ed9d13">name: &#34;gnome-chess&#34;
</span><span style="color:#ed9d13">version: &#34;0.1&#34;
</span><span style="color:#ed9d13">EOF</span>
</code></pre></td></tr></table>
</div>
</div><p>Here the version doesn&rsquo;t really matter, it&rsquo;s mostly for you to keep it track in your system. You can decide to follow strictly the versioning from gnome-chess, or not.</p>
<p>Now let&rsquo;s get to the important part, the build definition. This tells luet how to compile your package:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat <span style="color:#ed9d13">&lt;&lt;EOF &gt;&gt;tree/gnome-chess/build.yaml
</span><span style="color:#ed9d13">steps:
</span><span style="color:#ed9d13">- emerge games-board/gnome-chess
</span><span style="color:#ed9d13">requires:
</span><span style="color:#ed9d13">- category: &#34;layers&#34;
</span><span style="color:#ed9d13">  name: &#34;gnome&#34;
</span><span style="color:#ed9d13">  version: &#34;&gt;=0&#34;
</span><span style="color:#ed9d13">EOF</span>
</code></pre></td></tr></table>
</div>
</div><p>as you see, we are using emerge here to compile the package. The requires section tells from where it runs the command, which in this case is the MocaccinoOS desktop gnome layer. To see all the layers available, run <code>luet search layers</code> or to see the currently installed, you can run <code>luet search --installed layers</code>).</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Even if the example shows how to build a package with emerge, it is although possible to create packages out from any docker image - even not by compiling. You have to be careful to check if any package dependencies are actually already shipped by the layers

</div>

<p>Now let&rsquo;s add an installation hook to our package, in our specific case (gnome-chess) we need a trigger to generate glib schemas right after the package gets installed in the system:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat <span style="color:#ed9d13">&lt;&lt;EOF &gt;&gt;tree/gnome-chess/finalize.yaml
</span><span style="color:#ed9d13">install:
</span><span style="color:#ed9d13">- glib-compile-schemas /usr/share/glib-2.0/schemas
</span><span style="color:#ed9d13">EOF</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="building-the-package">Building the package</h2>
<p>Now let&rsquo;s build the packages (remember to run as root, or with <code>sudo</code> upfront):</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ luet build --tree tree --pull --pull-repository quay.io/mocaccino/desktop --from-repositories --live-output --only-target-package apps/gnome-chess
</code></pre></td></tr></table>
</div>
</div>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    The first time can take up some time due to downloading the images, but those are cached locally for local iteration. Time for a coffee!

</div>

<p>After build is completed, generate the repository metadata:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ luet create-repo --tree tree
</code></pre></td></tr></table>
</div>
</div><h2 id="install-the-package">Install the package</h2>
<p>First let&rsquo;s consume the repository we just created in our system:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat <span style="color:#ed9d13">&lt;&lt;EOF &gt;&gt; /etc/luet/repos.conf.d/local.yaml
</span><span style="color:#ed9d13">name: &#34;local-repository&#34;
</span><span style="color:#ed9d13">description: &#34;Local repository&#34;
</span><span style="color:#ed9d13">type: &#34;disk&#34;
</span><span style="color:#ed9d13">enable: true
</span><span style="color:#ed9d13">cached: true
</span><span style="color:#ed9d13">priority: 99
</span><span style="color:#ed9d13">urls: # Repository URLs
</span><span style="color:#ed9d13">  - /user/system_repository/build
</span><span style="color:#ed9d13">EOF</span>
</code></pre></td></tr></table>
</div>
</div><p>Now we are ready to install <code>gnome-chess</code> locally:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ luet install apps/gnome-chess
</code></pre></td></tr></table>
</div>
</div><h2 id="advanced-topics">Advanced topics</h2>
<h3 id="showing-package-files">Showing package files</h3>
<p>Luet shows already all the files shipped by a package with <code>luet search</code>. For example:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ luet search apps/gnome-chess -o yaml
</code></pre></td></tr></table>
</div>
</div><h3 id="find-duplicate-files-shipped-by-packages">Find duplicate files shipped by packages</h3>
<p>You can check duplicate files into the package shipped by repositories, also before installing them:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">luet search -o json | luet filter
</code></pre></td></tr></table>
</div>
</div><p>This is particularly useful to check for any conflicting files with the system packages and the ones you are generating.</p>
<p>See also the <a href="/docs/desktop/development/howdoi/#how-do-i-find-the-duplicate-files-in-the-package-repositories">dev section</a> regarding duplicate files.</p>
<h3 id="removing-generated-docker-images">Removing generated docker images</h3>
<p>By default, images are tagged under <code>luet/cache</code>. So it&rsquo;s possible to remove all the cache images generated by removing the <code>luet/cache</code> and <code>quay.io/mocaccinocache/desktop</code> images, although, you should also prune afterwards the images not referenced anymore by any tag with <code>docker image prune</code>:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker images --filter=<span style="color:#ed9d13">&#39;reference=luet/cache&#39;</span> --format=<span style="color:#ed9d13">&#39;{{.Repository}}:{{.Tag}}&#39;</span> | xargs -r docker rmi
$ docker images --filter=<span style="color:#ed9d13">&#39;reference=quay.io/mocaccino/desktop&#39;</span> --format=<span style="color:#ed9d13">&#39;{{.Repository}}:{{.Tag}}&#39;</span> | xargs -r docker rmi
$ docker image prune
</code></pre></td></tr></table>
</div>
</div><p>A way to reclaim all the space occupied by docker more aggressively is by running <code>docker system prune</code>, but attention, this command will remove all the images, also the ones which weren&rsquo;t generated by <code>luet</code>:</p>
<div class="highlight"><div style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker system prune --force --volumes --all
</code></pre></td></tr></table>
</div>
</div><h2 id="references">References</h2>
<ul>
<li><a href="https://luet-lab.github.io/docs">Luet docs</a></li>
<li><a href="https://luet-lab.github.io/docs/docs/concepts/packages/">Luet Packages</a></li>
<li><a href="https://luet-lab.github.io/docs/docs/tutorials/hello_world/">Luet hello world</a></li>
<li><a href="https://github.com/Luet-lab/examples/tree/master/demo3/tree">Emerge ebuild example</a></li>
</ul>

	
	
	<div class="text-muted mt-5 pt-3 border-top">
  Last modified February 11, 2025: <a href="https://github.com/MocaccinoOS/website/commit/8dd16ff2d86e5a994fe73d4f247044ec90a3f534">Update release_v1.4.md (8dd16ff)</a>
</div>

</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Forum" aria-label="Forum">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/mocaccinoOS/mocaccino/discussions" aria-label="Forum">
      <i class="fab fa-discourse"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Telegram" aria-label="Telegram">
    <a class="text-white" target="_blank" rel="noopener" href="https://t.me/mocaccinoOS" aria-label="Telegram">
      <i class="fab fa-telegram"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/MocaccinoOs" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Matrix chat" aria-label="Matrix chat">
    <a class="text-white" target="_blank" rel="noopener" href="https://matrix.to/#/#mocaccinoOS:matrix.org" aria-label="Matrix chat">
      <i class="fas fa-comments"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/MocaccinoOS" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener" href="https://join.slack.com/t/luet/shared_invite/enQtOTQxMjcyNDQ0MDUxLWQ5ODVlNTI1MTYzNDRkYzkyYmM1YWE5YjM0NTliNDEzNmQwMTkxNDRhNDIzM2Y5NDBlOTZjZTYxYWQyNDE4YzY" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2025 MocaccinoOS org. All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='/js/tabpane-persist.js'></script>




















<script src="/js/main.min.8ab8f81ff7e1454d30024cd6f956d4d341c3a97e2a673f988065f2ee4e147922.js" integrity="sha256-irj4H/fhRU0wAkzW&#43;VbU00HDqX4qZz&#43;YgGXy7k4UeSI=" crossorigin="anonymous"></script>




  </body>
</html>